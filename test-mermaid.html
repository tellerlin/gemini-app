<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mermaid å›¾è¡¨æµ‹è¯•</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.9.0/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: "Noto Sans CJK SC", "Microsoft YaHei", "SimHei", Inter, system-ui, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-title {
            color: #333;
            border-bottom: 2px solid #007acc;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .error {
            background-color: #fff5f5;
            border: 1px solid #fed7d7;
            color: #c53030;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .success {
            background-color: #f0fff4;
            border: 1px solid #9ae6b4;
            color: #38a169;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .mermaid {
            text-align: center;
            margin: 20px 0;
        }
        
        pre {
            background: #f8f8f8;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª Mermaid å›¾è¡¨åŠŸèƒ½æµ‹è¯•</h1>
    
    <!-- æµ‹è¯•1ï¼šä¿®å¤å‰çš„é”™è¯¯è¯­æ³• -->
    <div class="test-section">
        <h2 class="test-title">æµ‹è¯•1ï¼šåŸå§‹é”™è¯¯è¯­æ³•ï¼ˆåº”è¯¥å¤±è´¥ï¼‰</h2>
        <div id="result1" class="error">æ­£åœ¨æµ‹è¯•...</div>
        <pre>graph TD
    A[å¼€å§‹] -->|> B{é€‰æ‹©æ“ä½œ};
    B| C{æ“ä½œ1};
    B -->|> D{æ“ä½œ2};</pre>
        <div class="mermaid" id="mermaid1">
graph TD
    A[å¼€å§‹] -->|> B{é€‰æ‹©æ“ä½œ};
    B| C{æ“ä½œ1};
    B -->|> D{æ“ä½œ2};
        </div>
    </div>

    <!-- æµ‹è¯•2ï¼šä¿®å¤åçš„æ­£ç¡®è¯­æ³• -->
    <div class="test-section">
        <h2 class="test-title">æµ‹è¯•2ï¼šä¿®å¤åçš„æ­£ç¡®è¯­æ³•ï¼ˆåº”è¯¥æˆåŠŸï¼‰</h2>
        <div id="result2" class="success">æ­£åœ¨æµ‹è¯•...</div>
        <pre>graph TD
    A[å¼€å§‹] --> B{é€‰æ‹©æ“ä½œ}
    B --> C[æ“ä½œ1]
    B --> D[æ“ä½œ2]
    C --> E[å¤„ç†æ“ä½œ1]
    D --> F[å¤„ç†æ“ä½œ2]
    E --> G[ç»“æŸ]
    F --> G</pre>
        <div class="mermaid" id="mermaid2">
graph TD
    A[å¼€å§‹] --> B{é€‰æ‹©æ“ä½œ}
    B --> C[æ“ä½œ1]
    B --> D[æ“ä½œ2]
    C --> E[å¤„ç†æ“ä½œ1]
    D --> F[å¤„ç†æ“ä½œ2]
    E --> G[ç»“æŸ]
    F --> G
        </div>
    </div>

    <!-- æµ‹è¯•3ï¼šå¸¦æ ‡ç­¾çš„æ­£ç¡®è¯­æ³• -->
    <div class="test-section">
        <h2 class="test-title">æµ‹è¯•3ï¼šå¸¦æ ‡ç­¾çš„æ­£ç¡®è¯­æ³•</h2>
        <div id="result3" class="success">æ­£åœ¨æµ‹è¯•...</div>
        <pre>graph TD
    A[è¾“å…¥å‡­æ®] --> B{éªŒè¯å‡­æ®?}
    B -->|æ˜¯| C[ç™»å½•æˆåŠŸ]
    B -->|å¦| D[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    C --> E[è¿›å…¥ç³»ç»Ÿ]
    D --> A</pre>
        <div class="mermaid" id="mermaid3">
graph TD
    A[è¾“å…¥å‡­æ®] --> B{éªŒè¯å‡­æ®?}
    B -->|æ˜¯| C[ç™»å½•æˆåŠŸ]
    B -->|å¦| D[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    C --> E[è¿›å…¥ç³»ç»Ÿ]
    D --> A
        </div>
    </div>

    <!-- æµ‹è¯•4ï¼šå¤æ‚å­å›¾ -->
    <div class="test-section">
        <h2 class="test-title">æµ‹è¯•4ï¼šå¤æ‚å­å›¾</h2>
        <div id="result4" class="success">æ­£åœ¨æµ‹è¯•...</div>
        <pre>graph TD
    subgraph ç”¨æˆ·è®¤è¯
        A[è¾“å…¥å‡­æ®] --> B{éªŒè¯å‡­æ®?}
        B -->|æ˜¯| C[ç™»å½•æˆåŠŸ]
        B -->|å¦| D[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    end

    subgraph è´­ç‰©æµç¨‹
        E[æµè§ˆå•†å“] --> F[æ·»åŠ åˆ°è´­ç‰©è½¦]
        F --> G{ç¡®è®¤è®¢å•?}
        G -->|æ˜¯| H[æ”¯ä»˜]
        G -->|å¦| E
    end

    C --> E
    H --> I[è®¢å•å®Œæˆ]</pre>
        <div class="mermaid" id="mermaid4">
graph TD
    subgraph ç”¨æˆ·è®¤è¯
        A[è¾“å…¥å‡­æ®] --> B{éªŒè¯å‡­æ®?}
        B -->|æ˜¯| C[ç™»å½•æˆåŠŸ]
        B -->|å¦| D[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    end

    subgraph è´­ç‰©æµç¨‹
        E[æµè§ˆå•†å“] --> F[æ·»åŠ åˆ°è´­ç‰©è½¦]
        F --> G{ç¡®è®¤è®¢å•?}
        G -->|æ˜¯| H[æ”¯ä»˜]
        G -->|å¦| E
    end

    C --> E
    H --> I[è®¢å•å®Œæˆ]
        </div>
    </div>

    <!-- æµ‹è¯•5ï¼šæ—¶åºå›¾ -->
    <div class="test-section">
        <h2 class="test-title">æµ‹è¯•5ï¼šæ—¶åºå›¾</h2>
        <div id="result5" class="success">æ­£åœ¨æµ‹è¯•...</div>
        <pre>sequenceDiagram
    participant ç”¨æˆ·
    participant å‰ç«¯
    participant åç«¯
    participant æ•°æ®åº“

    ç”¨æˆ·->>å‰ç«¯: ç™»å½•è¯·æ±‚
    å‰ç«¯->>åç«¯: éªŒè¯å‡­æ®
    åç«¯->>æ•°æ®åº“: æŸ¥è¯¢ç”¨æˆ·
    æ•°æ®åº“-->>åç«¯: è¿”å›ç”¨æˆ·ä¿¡æ¯
    åç«¯-->>å‰ç«¯: éªŒè¯ç»“æœ
    å‰ç«¯-->>ç”¨æˆ·: æ˜¾ç¤ºç»“æœ</pre>
        <div class="mermaid" id="mermaid5">
sequenceDiagram
    participant ç”¨æˆ·
    participant å‰ç«¯
    participant åç«¯
    participant æ•°æ®åº“

    ç”¨æˆ·->>å‰ç«¯: ç™»å½•è¯·æ±‚
    å‰ç«¯->>åç«¯: éªŒè¯å‡­æ®
    åç«¯->>æ•°æ®åº“: æŸ¥è¯¢ç”¨æˆ·
    æ•°æ®åº“-->>åç«¯: è¿”å›ç”¨æˆ·ä¿¡æ¯
    åç«¯-->>å‰ç«¯: éªŒè¯ç»“æœ
    å‰ç«¯-->>ç”¨æˆ·: æ˜¾ç¤ºç»“æœ
        </div>
    </div>

    <script>
        // é…ç½® Mermaid
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: '"Noto Sans CJK SC", "Microsoft YaHei", "SimHei", Inter, system-ui, sans-serif',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35
            }
        });

        // æµ‹è¯•å‡½æ•°
        async function testMermaidDiagram(id, resultId) {
            const element = document.getElementById(id);
            const resultElement = document.getElementById(resultId);
            
            try {
                await mermaid.run({
                    nodes: [element]
                });
                resultElement.textContent = 'âœ… æ¸²æŸ“æˆåŠŸ';
                resultElement.className = 'success';
            } catch (error) {
                console.error(`${id} æ¸²æŸ“å¤±è´¥:`, error);
                resultElement.textContent = `âŒ æ¸²æŸ“å¤±è´¥: ${error.message}`;
                resultElement.className = 'error';
            }
        }

        // ä¾æ¬¡æµ‹è¯•æ‰€æœ‰å›¾è¡¨
        async function runAllTests() {
            const tests = [
                { id: 'mermaid1', resultId: 'result1' },
                { id: 'mermaid2', resultId: 'result2' },
                { id: 'mermaid3', resultId: 'result3' },
                { id: 'mermaid4', resultId: 'result4' },
                { id: 'mermaid5', resultId: 'result5' }
            ];

            for (const test of tests) {
                await testMermaidDiagram(test.id, test.resultId);
                await new Promise(resolve => setTimeout(resolve, 500)); // å»¶è¿Ÿ500ms
            }

            // æ˜¾ç¤ºæµ‹è¯•æ±‡æ€»
            const results = tests.map(test => {
                const resultElement = document.getElementById(test.resultId);
                return resultElement.className === 'success';
            });

            const passed = results.filter(r => r).length;
            const total = results.length;

            console.log(`æµ‹è¯•å®Œæˆ: ${passed}/${total} é€šè¿‡`);
            
            // åœ¨é¡µé¢åº•éƒ¨æ·»åŠ æµ‹è¯•æ±‡æ€»
            const summary = document.createElement('div');
            summary.className = 'test-section';
            summary.innerHTML = `
                <h2 class="test-title">ğŸ“Š æµ‹è¯•æ±‡æ€»</h2>
                <div class="${passed === total ? 'success' : 'error'}">
                    æ€»æµ‹è¯•æ•°: ${total}<br>
                    é€šè¿‡: ${passed}<br>
                    å¤±è´¥: ${total - passed}<br>
                    æˆåŠŸç‡: ${Math.round(passed / total * 100)}%
                </div>
            `;
            document.body.appendChild(summary);
        }

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œæµ‹è¯•
        document.addEventListener('DOMContentLoaded', runAllTests);
    </script>
</body>
</html>